{"paragraphs":[{"title":"Introduction","text":"%md\nHadoop is gradually playing a larger role as a system of record for many workloads. Systems of record need robust and varied options for data updates that may range from single records to complex multi-step transactions.\n\nSome reasons to perform updates may include:\n\n- Data restatements from upstream data providers.\n- Data pipeline reprocessing.\n- Slowly-changing dimensions (e.g. SCD Type 1)\n- Dimension history / evolution (e.g. SCD Type 2)\n\nStandard SQL provides ACID operations through INSERT, UPDATE, DELETE, transactions, and the more recent MERGE operations. These have proven to be robust and flexible enough for most workloads.","user":"etl_user","dateUpdated":"2020-01-09T02:22:10+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Hadoop is gradually playing a larger role as a system of record for many workloads. Systems of record need robust and varied options for data updates that may range from single records to complex multi-step transactions.</p>\n<p>Some reasons to perform updates may include:</p>\n<ul>\n<li>Data restatements from upstream data providers.</li>\n<li>Data pipeline reprocessing.</li>\n<li>Slowly-changing dimensions (e.g. SCD Type 1)</li>\n<li>Dimension history / evolution (e.g. SCD Type 2)</li>\n</ul>\n<p>Standard SQL provides ACID operations through INSERT, UPDATE, DELETE, transactions, and the more recent MERGE operations. These have proven to be robust and flexible enough for most workloads.</p>\n\n</div>"}]},"apps":[],"jobName":"paragraph_1578535795247_538474535","id":"20200109-020955_1049020014","dateCreated":"2020-01-09T02:09:55+0000","dateStarted":"2020-01-09T02:22:09+0000","dateFinished":"2020-01-09T02:22:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18908"},{"title":"Concepts","text":"%md\n**Transactional Tables**: Hive supports single-table transactions. Tables must be marked as transactional in order to support UPDATE and DELETE operations.\n**Partitioned Tables**: Hive supports table partitioning as a means of separating data for faster writes and queries. Partitions are independent of ACID. Large tables in Hive are almost always partitioned. Large ACID tables should be partitioned for optimal performance.\n**ACID Operations (INSERT / UPDATE / DELETE)**: Standard SQL commands that allow data inserts, updates and deletes.\n**Primary Key**: Databases use primary keys to make records easy to locate, which facilitates updates or deletes. Hive does not enforce the notion of primary keys, but if you plan to do large-scale updates and deletes you should establish a primary key convention within your application.\n**Streaming Ingest**: Data can be streamed into transactional Hive tables in real-time using NiFi, Flume or a lower-level direct API.\n**Optimistic Concurrency**: ACID updates and deletes to Hive tables are resolved by letting the first committer win. This happens at the partition level, or at the table level for unpartitioned tables.\n**Compactions**: Data must be periodically compacted to save space and optimize data access. It is best to let the system handle these automatically, but these can also be scheduled in an external scheduler.","user":"etl_user","dateUpdated":"2020-01-09T02:23:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","title":true,"editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p><strong>Transactional Tables</strong>: Hive supports single-table transactions. Tables must be marked as transactional in order to support UPDATE and DELETE operations.<br />\n<strong>Partitioned Tables</strong>: Hive supports table partitioning as a means of separating data for faster writes and queries. Partitions are independent of ACID. Large tables in Hive are almost always partitioned. Large ACID tables should be partitioned for optimal performance.<br />\n<strong>ACID Operations (INSERT / UPDATE / DELETE)</strong>: Standard SQL commands that allow data inserts, updates and deletes.<br />\n<strong>Primary Key</strong>: Databases use primary keys to make records easy to locate, which facilitates updates or deletes. Hive does not enforce the notion of primary keys, but if you plan to do large-scale updates and deletes you should establish a primary key convention within your application.<br />\n<strong>Streaming Ingest</strong>: Data can be streamed into transactional Hive tables in real-time using NiFi, Flume or a lower-level direct API.<br />\n<strong>Optimistic Concurrency</strong>: ACID updates and deletes to Hive tables are resolved by letting the first committer win. This happens at the partition level, or at the table level for unpartitioned tables.<br />\n<strong>Compactions</strong>: Data must be periodically compacted to save space and optimize data access. It is best to let the system handle these automatically, but these can also be scheduled in an external scheduler.</p>\n\n</div>"}]},"apps":[],"jobName":"paragraph_1578535722013_-721633058","id":"20200109-020842_150940467","dateCreated":"2020-01-09T02:08:42+0000","dateStarted":"2020-01-09T02:23:27+0000","dateFinished":"2020-01-09T02:23:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18909"},{"title":"Hello ACID: Create a Partitioned ACID Table and Insert some Data","text":"%md\nLet’s start by creating a transactional table. Only transactional tables can support updates and deletes\n","user":"etl_user","dateUpdated":"2020-01-09T02:08:29+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false,"lineNumbers":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Let’s start by creating a transactional table. Only transactional tables can support updates and deletes</p>\n\n</div>"}]},"apps":[],"jobName":"paragraph_1578534148129_-699879680","id":"20200109-014228_523114707","dateCreated":"2020-01-09T01:42:28+0000","dateStarted":"2020-01-09T01:42:36+0000","dateFinished":"2020-01-09T01:42:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18910"},{"text":"%jdbc(hive)\nCREATE TABLE IF NOT EXISTS hello_acid (key int, value int)\nPARTITIONED BY (load_date date)\nCLUSTERED BY(key) INTO 3 BUCKETS","user":"etl_user","dateUpdated":"2020-01-09T02:22:51+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"}]},"apps":[],"jobName":"paragraph_1578533030717_-662008691","id":"20200109-012350_1277218171","dateCreated":"2020-01-09T01:23:50+0000","dateStarted":"2020-01-09T02:22:51+0000","dateFinished":"2020-01-09T02:22:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18911"},{"text":"%md\nChecking the table that was created using ```describe formatted```, notice that with Hive 3 tables are by default created as managed with ACID and ORC enabled","user":"etl_user","dateUpdated":"2020-01-09T02:15:03+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578535971097_1767701735","id":"20200109-021251_1794144759","dateCreated":"2020-01-09T02:12:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18913","dateFinished":"2020-01-09T02:15:03+0000","dateStarted":"2020-01-09T02:15:03+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Checking the table that was created using <code>describe formatted</code>, notice that with Hive 3 tables are by default created as managed with ACID and ORC enabled</p>\n\n</div>"}]},"focus":true},{"text":"%jdbc(hive)\ndescribe formatted hello_acid\n","user":"etl_user","dateUpdated":"2020-01-09T02:22:53+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"col_name\tdata_type\tcomment\nkey\tint\t\nvalue\tint\t\n\tnull\tnull\n# Partition Information\tnull\tnull\n# col_name\tdata_type\tcomment\nload_date\tdate\t\n\tnull\tnull\n# Detailed Table Information\tnull\tnull\nDatabase:           \tdefault             \tnull\nOwnerType:          \tUSER                \tnull\nOwner:              \tetl_user            \tnull\nCreateTime:         \tThu Jan 09 01:24:26 UTC 2020\tnull\nLastAccessTime:     \tUNKNOWN             \tnull\nRetention:          \t0                   \tnull\nLocation:           \thdfs://cdp.cloudera.com:8020/warehouse/tablespace/managed/hive/hello_acid\tnull\nTable Type:         \tMANAGED_TABLE       \tnull\nTable Parameters:\tnull\tnull\n\tCOLUMN_STATS_ACCURATE\t{\\\"BASIC_STATS\\\":\\\"true\\\"}\n\tbucketing_version   \t2                   \n\tnumFiles            \t6                   \n\tnumPartitions       \t3                   \n\tnumRows             \t2                   \n\trawDataSize         \t0                   \n\ttotalSize           \t4059                \n\ttransactional       \ttrue                \n\ttransactional_properties\tdefault             \n\ttransient_lastDdlTime\t1578533066          \n\tnull\tnull\n# Storage Information\tnull\tnull\nSerDe Library:      \torg.apache.hadoop.hive.ql.io.orc.OrcSerde\tnull\nInputFormat:        \torg.apache.hadoop.hive.ql.io.orc.OrcInputFormat\tnull\nOutputFormat:       \torg.apache.hadoop.hive.ql.io.orc.OrcOutputFormat\tnull\nCompressed:         \tNo                  \tnull\nNum Buckets:        \t3                   \tnull\nBucket Columns:     \t[key]               \tnull\nSort Columns:       \t[]                  \tnull\nStorage Desc Params:\tnull\tnull\n\tserialization.format\t1                   \n"}]},"apps":[],"jobName":"paragraph_1578535940291_-514944641","id":"20200109-021220_1994033484","dateCreated":"2020-01-09T02:12:20+0000","dateStarted":"2020-01-09T02:22:53+0000","dateFinished":"2020-01-09T02:22:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18912"},{"title":"Insert records","text":"%jdbc(hive)\nINSERT INTO hello_acid PARTITION (load_date) VALUES\n (1, 1, '2016-03-01'),\n (2, 2, '2016-03-02'),\n (3, 3, '2016-03-03')\n\n","user":"etl_user","dateUpdated":"2020-01-09T02:11:49+0000","config":{"colWidth":4,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"}]},"apps":[],"jobName":"paragraph_1578533066731_1910358408","id":"20200109-012426_1401686400","dateCreated":"2020-01-09T01:24:26+0000","dateStarted":"2020-01-09T01:29:14+0000","dateFinished":"2020-01-09T01:29:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18914"},{"title":"Delete record","text":"%jdbc(hive)\nDELETE FROM hello_acid WHERE key = 2","user":"etl_user","dateUpdated":"2020-01-09T02:12:00+0000","config":{"colWidth":4,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"}]},"apps":[],"jobName":"paragraph_1578533316164_-2102630308","id":"20200109-012836_1875470614","dateCreated":"2020-01-09T01:28:36+0000","dateStarted":"2020-01-09T01:29:38+0000","dateFinished":"2020-01-09T01:29:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18915"},{"title":"Update record","text":"%jdbc(hive)\nUPDATE hello_acid SET value = 10 WHERE key = 3","user":"etl_user","dateUpdated":"2020-01-09T02:12:08+0000","config":{"colWidth":4,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"}]},"apps":[],"jobName":"paragraph_1578533378166_1441478231","id":"20200109-012938_2063207831","dateCreated":"2020-01-09T01:29:38+0000","dateStarted":"2020-01-09T01:29:49+0000","dateFinished":"2020-01-09T01:29:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18916"},{"text":"%jdbc(hive)\nSELECT * FROM hello_acid","user":"etl_user","dateUpdated":"2020-01-09T02:24:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"hello_acid.key":"string","hello_acid.value":"string","hello_acid.load_date":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"hello_acid.key\thello_acid.value\thello_acid.load_date\n1\t1\t2016-03-01\n3\t10\t2016-03-03\n"}]},"apps":[],"jobName":"paragraph_1578533389821_206409882","id":"20200109-012949_872128704","dateCreated":"2020-01-09T01:29:49+0000","dateStarted":"2020-01-09T01:30:04+0000","dateFinished":"2020-01-09T01:30:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18917"},{"text":"%md\nThis example shows the most basic ways to add data into a Hive table using INSERT, UPDATE and DELETE commands. Later we will see some more powerful ways of adding data to an ACID table that involve loading staging tables and using INSERT, UPDATE or DELETE commands, combined with subqueries, to manage data in bulk.\n\nThese DML commands are designed to deal with large amounts of data in a microbatch manner. These DML statements should not be used for record-level data management. If you have small batches of constantly arriving, you should use Streaming Data Ingestion instead.\n","user":"etl_user","dateUpdated":"2020-01-09T02:24:15+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>This example shows the most basic ways to add data into a Hive table using INSERT, UPDATE and DELETE commands. Later we will see some more powerful ways of adding data to an ACID table that involve loading staging tables and using INSERT, UPDATE or DELETE commands, combined with subqueries, to manage data in bulk.</p>\n<p>These DML commands are designed to deal with large amounts of data in a microbatch manner. These DML statements should not be used for record-level data management. If you have small batches of constantly arriving, you should use Streaming Data Ingestion instead.</p>\n\n</div>"}]},"apps":[],"jobName":"paragraph_1578534117061_-528764228","id":"20200109-014157_777365482","dateCreated":"2020-01-09T01:41:57+0000","dateStarted":"2020-01-09T01:42:06+0000","dateFinished":"2020-01-09T01:42:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18918"},{"title":"Practical Uses of SQL ACID","text":"%md\nInserting a couple of records helps to get acquainted but in a real setting you need to deal with thousands or millions of records at a time. This section discusses how to get deal with data batches across a number of common scenarios.\n\nThese patterns require you to establish a primary key. Hive does not enforce primary key uniqueness, you will need to do this in your application. Although Hive 2.1 introduced the notion of non-validating foreign key relationships. There are currently no integrity checks enforced by the system.","user":"etl_user","dateUpdated":"2020-01-09T01:41:44+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Inserting a couple of records helps to get acquainted but in a real setting you need to deal with thousands or millions of records at a time. This section discusses how to get deal with data batches across a number of common scenarios.</p>\n<p>These patterns require you to establish a primary key. Hive does not enforce primary key uniqueness, you will need to do this in your application. Although Hive 2.1 introduced the notion of non-validating foreign key relationships. There are currently no integrity checks enforced by the system.</p>\n\n</div>"}]},"apps":[],"jobName":"paragraph_1578534078244_-345921161","id":"20200109-014118_390603061","dateCreated":"2020-01-09T01:41:18+0000","dateStarted":"2020-01-09T01:41:31+0000","dateFinished":"2020-01-09T01:41:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18919"},{"title":"Search Updates","text":"%md\nHive ACID supports searched updates, which are the most typical form of updates. It is important to realize that, based on Hive ACID’s architecture, updates must be done in bulk. Doing row-at-a-time updates will not work at any practical scale. Searched updates can work well when you’re doing a first pass to update a large number of records in a fixed way.\n\nFor example let’s consider a dimension table which includes a flag to indicate whether the record is the most current value. This allows tracking a dimension’s evolution over time, a common strategy for dealing with slowly-changing dimensions (SCDs). When a set of dimension table updates arrive you want to mark all existing values as old. This is easy to do with an in list and subquery on a common key.","user":"etl_user","dateUpdated":"2020-01-09T01:41:00+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Hive ACID supports searched updates, which are the most typical form of updates. It is important to realize that, based on Hive ACID’s architecture, updates must be done in bulk. Doing row-at-a-time updates will not work at any practical scale. Searched updates can work well when you’re doing a first pass to update a large number of records in a fixed way.</p>\n<p>For example let’s consider a dimension table which includes a flag to indicate whether the record is the most current value. This allows tracking a dimension’s evolution over time, a common strategy for dealing with slowly-changing dimensions (SCDs). When a set of dimension table updates arrive you want to mark all existing values as old. This is easy to do with an in list and subquery on a common key.</p>\n\n</div>"}]},"apps":[],"jobName":"paragraph_1578534039657_-549118382","id":"20200109-014039_1719436574","dateCreated":"2020-01-09T01:40:39+0000","dateStarted":"2020-01-09T01:40:47+0000","dateFinished":"2020-01-09T01:40:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18920"},{"text":"%jdbc(hive)\nCREATE TABLE IF NOT EXISTS mydim (key int, name string, zip string, is_current boolean)\nCLUSTERED BY (key) INTO 3 BUCKETS","user":"etl_user","dateUpdated":"2020-01-09T02:25:10+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"}]},"apps":[],"jobName":"paragraph_1578533507256_197648302","id":"20200109-013147_316843791","dateCreated":"2020-01-09T01:31:47+0000","dateStarted":"2020-01-09T02:25:10+0000","dateFinished":"2020-01-09T02:25:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18921"},{"text":"%jdbc(hive)\nINSERT INTO mydim VALUES\n  (1, 'bob',  '95136', true),\n  (2, 'joe',  '70068', true),\n  (3, 'steve', '22150', true)","user":"etl_user","dateUpdated":"2020-01-09T01:40:33+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"}]},"apps":[],"jobName":"paragraph_1578533572607_-583658004","id":"20200109-013252_1266207058","dateCreated":"2020-01-09T01:32:52+0000","dateStarted":"2020-01-09T01:33:04+0000","dateFinished":"2020-01-09T01:33:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18922"},{"text":"%jdbc(hive)\nDROP TABLE IF EXISTS updates_staging_table","user":"etl_user","dateUpdated":"2020-01-09T01:36:03+0000","config":{"colWidth":4,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"}]},"apps":[],"jobName":"paragraph_1578533597335_256981829","id":"20200109-013317_1279971443","dateCreated":"2020-01-09T01:33:17+0000","dateStarted":"2020-01-09T01:33:37+0000","dateFinished":"2020-01-09T01:33:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18923"},{"text":"%jdbc(hive)\nCREATE TABLE updates_staging_table \n(key int, newzip string)","user":"etl_user","dateUpdated":"2020-01-09T01:36:07+0000","config":{"colWidth":4,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"}]},"apps":[],"jobName":"paragraph_1578533620319_1372803746","id":"20200109-013340_869432385","dateCreated":"2020-01-09T01:33:40+0000","dateStarted":"2020-01-09T01:34:04+0000","dateFinished":"2020-01-09T01:34:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18924"},{"text":"%jdbc(hive)\nINSERT INTO updates_staging_table VALUES\n(1, 87102), (3, 45220)","user":"etl_user","dateUpdated":"2020-01-09T01:36:10+0000","config":{"colWidth":4,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"}]},"apps":[],"jobName":"paragraph_1578533653622_-1299035528","id":"20200109-013413_1993333275","dateCreated":"2020-01-09T01:34:13+0000","dateStarted":"2020-01-09T01:34:29+0000","dateFinished":"2020-01-09T01:34:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18925"},{"text":"%jdbc(hive)\nSELECT * FROM mydim","user":"etl_user","dateUpdated":"2020-01-09T02:16:22+0000","config":{"colWidth":4,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"mydim.key":"string","mydim.name":"string","mydim.zip":"string","mydim.is_current":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"mydim.key\tmydim.name\tmydim.zip\tmydim.is_current\n1\tbob\t95136\ttrue\n2\tjoe\t70068\ttrue\n3\tsteve\t22150\ttrue\n"}]},"apps":[],"jobName":"paragraph_1578533691127_-646880224","id":"20200109-013451_1622226851","dateCreated":"2020-01-09T01:34:51+0000","dateStarted":"2020-01-09T01:35:00+0000","dateFinished":"2020-01-09T01:35:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18926","title":"State before running searched update"},{"text":"%jdbc(hive)\nUPDATE mydim SET is_current = false\n  WHERE mydim.key IN (SELECT key FROM updates_staging_table)","user":"etl_user","dateUpdated":"2020-01-09T02:16:32+0000","config":{"colWidth":4,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"}]},"apps":[],"jobName":"paragraph_1578533707966_1717692121","id":"20200109-013507_922353731","dateCreated":"2020-01-09T01:35:07+0000","dateStarted":"2020-01-09T01:35:25+0000","dateFinished":"2020-01-09T01:35:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18927","title":"Run searched update"},{"text":"%jdbc(hive)\nSELECT * FROM mydim","user":"etl_user","dateUpdated":"2020-01-09T02:16:47+0000","config":{"colWidth":4,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"mydim.key":"string","mydim.name":"string","mydim.zip":"string","mydim.is_current":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"mydim.key\tmydim.name\tmydim.zip\tmydim.is_current\n2\tjoe\t70068\ttrue\n1\tbob\t95136\tfalse\n3\tsteve\t22150\tfalse\n"}]},"apps":[],"jobName":"paragraph_1578533730787_1015994899","id":"20200109-013530_1477493869","dateCreated":"2020-01-09T01:35:30+0000","dateStarted":"2020-01-09T01:35:44+0000","dateFinished":"2020-01-09T01:35:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18928","title":"State after running searched update"},{"text":"%md\nThe result will be that records 1 and 3 have their is_current flag set to false. From there we can add the new, updated values to the end of the table with their is_current flag set to true.","user":"etl_user","dateUpdated":"2020-01-09T01:36:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>The result will be that records 1 and 3 have their is_current flag set to false. From there we can add the new, updated values to the end of the table with their is_current flag set to true.</p>\n\n</div>"}]},"apps":[],"jobName":"paragraph_1578533800754_-908868257","id":"20200109-013640_1275261465","dateCreated":"2020-01-09T01:36:40+0000","dateStarted":"2020-01-09T01:36:48+0000","dateFinished":"2020-01-09T01:36:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18929"},{"title":"Searched Deletes","text":"%md\nBulk deletes can be done easily with a staging table and in list + subquery. This requires you have a common key between the tables, similar to how you would use a primary key in RDBMS.","user":"etl_user","dateUpdated":"2020-01-09T01:38:00+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Bulk deletes can be done easily with a staging table and in list + subquery. This requires you have a common key between the tables, similar to how you would use a primary key in RDBMS.</p>\n\n</div>"}]},"apps":[],"jobName":"paragraph_1578533836233_-1547649339","id":"20200109-013716_1153981214","dateCreated":"2020-01-09T01:37:16+0000","dateStarted":"2020-01-09T01:38:00+0000","dateFinished":"2020-01-09T01:38:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18930"},{"text":"%jdbc(hive)\nDELETE FROM mydim\n  WHERE mydim.key IN (SELECT key FROM updates_staging_table)\n","user":"etl_user","dateUpdated":"2020-01-09T01:38:30+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"}]},"apps":[],"jobName":"paragraph_1578533887988_-2000835076","id":"20200109-013807_2007734451","dateCreated":"2020-01-09T01:38:07+0000","dateStarted":"2020-01-09T01:38:30+0000","dateFinished":"2020-01-09T01:38:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18931"},{"text":"%jdbc(hive)\nSELECT * FROM mydim","user":"etl_user","dateUpdated":"2020-01-09T01:38:52+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"mydim.key":"string","mydim.name":"string","mydim.zip":"string","mydim.is_current":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"mydim.key\tmydim.name\tmydim.zip\tmydim.is_current\n2\tjoe\t70068\ttrue\n"}]},"apps":[],"jobName":"paragraph_1578533908622_-757315258","id":"20200109-013828_1974646364","dateCreated":"2020-01-09T01:38:28+0000","dateStarted":"2020-01-09T01:38:51+0000","dateFinished":"2020-01-09T01:38:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18932"},{"text":"%md\nThere are situations where you need to update a batch of records to a new set of values. For example, Type 1 SCD updates or restatements of inaccurate data. Hive now supports SQL MERGE, which will make this task easy.","user":"etl_user","dateUpdated":"2020-01-09T02:27:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578536819760_169460533","id":"20200109-022659_1027235320","dateCreated":"2020-01-09T02:26:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:27441","dateFinished":"2020-01-09T02:27:27+0000","dateStarted":"2020-01-09T02:27:27+0000","title":"Overwriting Existing Records with New Records","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>There are situations where you need to update a batch of records to a new set of values. For example, Type 1 SCD updates or restatements of inaccurate data. Hive now supports SQL MERGE, which will make this task easy.</p>\n\n</div>"}]}},{"text":"%md\nACID transactions create a number of locks during the course of their operation. Transactions and their locks can be viewed using a number of tools within Hive.","user":"etl_user","dateUpdated":"2020-01-09T02:27:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578536850009_791703835","id":"20200109-022730_1247398573","dateCreated":"2020-01-09T02:27:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:27566","dateFinished":"2020-01-09T02:27:51+0000","dateStarted":"2020-01-09T02:27:51+0000","title":"Operational Tools for ACID","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>ACID transactions create a number of locks during the course of their operation. Transactions and their locks can be viewed using a number of tools within Hive.</p>\n\n</div>"}]}},{"text":"%jdbc(hive)\nshow transactions","user":"etl_user","dateUpdated":"2020-01-09T02:26:13+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"txnid":"string","state":"string","startedtime":"string","lastheartbeattime":"string","user":"string","host":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"txnid\tstate\tstartedtime\tlastheartbeattime\tuser\thost\nTransaction ID\tTransaction State\tStarted Time\tLast Heartbeat Time\tUser\tHostname\n38\tABORTED\t1578453109000\t1578453109000\thive/cdp.cloudera.com@CLOUDERA.COM\tcdp.cloudera.com\n40\tABORTED\t1578453125000\t1578453125000\thive/cdp.cloudera.com@CLOUDERA.COM\tcdp.cloudera.com\n41\tABORTED\t1578453130000\t1578453130000\thive/cdp.cloudera.com@CLOUDERA.COM\tcdp.cloudera.com\n42\tABORTED\t1578453136000\t1578453136000\thive/cdp.cloudera.com@CLOUDERA.COM\tcdp.cloudera.com\n44\tABORTED\t1578453147000\t1578453147000\thive/cdp.cloudera.com@CLOUDERA.COM\tcdp.cloudera.com\n45\tABORTED\t1578524874000\t1578524874000\thive/cdp.cloudera.com@CLOUDERA.COM\tcdp.cloudera.com\n48\tABORTED\t1578524939000\t1578524939000\thive/cdp.cloudera.com@CLOUDERA.COM\tcdp.cloudera.com\n53\tABORTED\t1578525026000\t1578525026000\thive/cdp.cloudera.com@CLOUDERA.COM\tcdp.cloudera.com\n54\tABORTED\t1578525031000\t1578525031000\thive/cdp.cloudera.com@CLOUDERA.COM\tcdp.cloudera.com\n55\tABORTED\t1578525586000\t1578525586000\thive/cdp.cloudera.com@CLOUDERA.COM\tcdp.cloudera.com\n58\tABORTED\t1578526904000\t1578526904000\thive/cdp.cloudera.com@CLOUDERA.COM\tcdp.cloudera.com\n70\tABORTED\t1578527490000\t1578527490000\thive/cdp.cloudera.com@CLOUDERA.COM\tcdp.cloudera.com\n71\tABORTED\t1578527540000\t1578527540000\thive/cdp.cloudera.com@CLOUDERA.COM\tcdp.cloudera.com\n73\tABORTED\t1578527603000\t1578527603000\thive/cdp.cloudera.com@CLOUDERA.COM\tcdp.cloudera.com\n74\tABORTED\t1578527608000\t1578527608000\thive/cdp.cloudera.com@CLOUDERA.COM\tcdp.cloudera.com\n78\tABORTED\t1578527800000\t1578527800000\thive/cdp.cloudera.com@CLOUDERA.COM\tcdp.cloudera.com\n96\tABORTED\t1578530495000\t1578530495000\thive/cdp.cloudera.com@CLOUDERA.COM\tcdp.cloudera.com\n108\tABORTED\t1578533320000\t1578533320000\thive/cdp.cloudera.com@CLOUDERA.COM\tcdp.cloudera.com\n"}]},"apps":[],"jobName":"paragraph_1578533400603_-651010061","id":"20200109-013000_2003866782","dateCreated":"2020-01-09T01:30:00+0000","dateStarted":"2020-01-09T01:30:58+0000","dateFinished":"2020-01-09T01:30:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18933","title":"Seeing Transactions"},{"text":"%jdbc(hive)\nshow locks","user":"etl_user","dateUpdated":"2020-01-09T02:26:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"lockid":"string","database":"string","table":"string","partition":"string","lock_state":"string","blocked_by":"string","lock_type":"string","transaction_id":"string","last_heartbeat":"string","acquired_at":"string","user":"string","hostname":"string","agent_info":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"lockid\tdatabase\ttable\tpartition\tlock_state\tblocked_by\tlock_type\ttransaction_id\tlast_heartbeat\tacquired_at\tuser\thostname\tagent_info\nLock ID\tDatabase\tTable\tPartition\tState\tBlocked By\tType\tTransaction ID\tLast Heartbeat\tAcquired At\tUser\tHostname\tAgent Info\n"}]},"apps":[],"jobName":"paragraph_1578533454798_-1243159735","id":"20200109-013054_2145144280","dateCreated":"2020-01-09T01:30:54+0000","dateStarted":"2020-01-09T01:31:25+0000","dateFinished":"2020-01-09T01:31:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18934","title":"Seeing Locks"},{"text":"%md\nIt may be necessary to abort a transaction, for example because a transaction is running too long. You can abort a set of transactions using “abort transactions” followed by a list of numeric transaction IDs. Note that aborting a transaction won’t kill the related query immediately. Instead ACID queries periodically heartbeat, every 2.5 minutes by default, and if they detect their underlying transaction has been aborted they will exit at that time.","user":"etl_user","dateUpdated":"2020-01-09T02:18:26+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578536284325_1068820322","id":"20200109-021804_978082567","dateCreated":"2020-01-09T02:18:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:25709","dateFinished":"2020-01-09T02:18:19+0000","dateStarted":"2020-01-09T02:18:19+0000","title":"Aborting Transactions","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>It may be necessary to abort a transaction, for example because a transaction is running too long. You can abort a set of transactions using “abort transactions” followed by a list of numeric transaction IDs. Note that aborting a transaction won’t kill the related query immediately. Instead ACID queries periodically heartbeat, every 2.5 minutes by default, and if they detect their underlying transaction has been aborted they will exit at that time.</p>\n\n</div>"}]}},{"text":"%md\nThese performance tips will help you survive in the real world:\n\n1. Partition your data. Hive compactions are not tiered: major compactions re-write all data in modified partitions, one partition at a time. Partitioning data is essential to ensure you can manage large datasets without degradation. Partitioning by date is the most common approach.\n\n2. Inserts are fast, updates and deletes are relatively slower. Updates and deletes perform full partition scans. Plan for this by batching data appropriately.\n\n3. If your workload includes a large number of updates and deletes, compact regularly. Your total data size will grow until you compact, and analytical queries will slowly degrade until compaction is done.\n","user":"etl_user","dateUpdated":"2020-01-09T02:18:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578533485163_780369807","id":"20200109-013125_1896808873","dateCreated":"2020-01-09T01:31:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18935","dateFinished":"2020-01-09T02:18:34+0000","dateStarted":"2020-01-09T02:18:34+0000","title":"Real-World Performance Considerations","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>These performance tips will help you survive in the real world:</p>\n<ol>\n<li>\n<p>Partition your data. Hive compactions are not tiered: major compactions re-write all data in modified partitions, one partition at a time. Partitioning data is essential to ensure you can manage large datasets without degradation. Partitioning by date is the most common approach.</p>\n</li>\n<li>\n<p>Inserts are fast, updates and deletes are relatively slower. Updates and deletes perform full partition scans. Plan for this by batching data appropriately.</p>\n</li>\n<li>\n<p>If your workload includes a large number of updates and deletes, compact regularly. Your total data size will grow until you compact, and analytical queries will slowly degrade until compaction is done.</p>\n</li>\n</ol>\n\n</div>"}]}},{"text":"%md\nIn the real world things go wrong. When things go wrong you need options for creative solutions. At Cloudera, we have used the information in this section to get past some very tricky problems.\n**Warning**: Improper application of this information may cause data corruption or permanent data loss. Ensure you fully understand the system before using this information, test it out on data you can afford to lose and always backup any data you really care about.\n\nACID tables have a hidden column called row__id. You should consider this column a system internal and assume that its name or even its presence may change at any time without warning. You should not build a long-term solution on top of this column, only use it to get you past a tough spot.\n\nWith that out of the way, this column records:\n\nThe transactionid that was active when the data was inserted or updated.\nThe bucketid, the bucket number where the data lives.\nThe rowid, the rowid within this transaction/bucket combo.","user":"etl_user","dateUpdated":"2020-01-09T02:20:10+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578536350952_-1701742458","id":"20200109-021910_758119566","dateCreated":"2020-01-09T02:19:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:26230","dateFinished":"2020-01-09T02:19:53+0000","dateStarted":"2020-01-09T02:19:53+0000","title":"Experts only","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>In the real world things go wrong. When things go wrong you need options for creative solutions. At Cloudera, we have used the information in this section to get past some very tricky problems.<br />\n<strong>Warning</strong>: Improper application of this information may cause data corruption or permanent data loss. Ensure you fully understand the system before using this information, test it out on data you can afford to lose and always backup any data you really care about.</p>\n<p>ACID tables have a hidden column called row__id. You should consider this column a system internal and assume that its name or even its presence may change at any time without warning. You should not build a long-term solution on top of this column, only use it to get you past a tough spot.</p>\n<p>With that out of the way, this column records:</p>\n<p>The transactionid that was active when the data was inserted or updated.<br />\nThe bucketid, the bucket number where the data lives.<br />\nThe rowid, the rowid within this transaction/bucket combo.</p>\n\n</div>"}]}},{"text":"%jdbc(hive)\nselect row__id from hello_acid","user":"etl_user","dateUpdated":"2020-01-09T02:19:08+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"row__id":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578536257551_741700563","id":"20200109-021737_1850305704","dateCreated":"2020-01-09T02:17:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:25602","dateFinished":"2020-01-09T02:19:06+0000","dateStarted":"2020-01-09T02:19:05+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"row__id\n{\"writeid\":1,\"bucketid\":536936448,\"rowid\":0}\n{\"writeid\":3,\"bucketid\":537001984,\"rowid\":0}\n"}]}},{"text":"%md\nA common need is to confirm that all records were ingested. Let’s say your upstream provider insists data is missing in Hive. Your provider (e.g. Storm Bolt) can tell you the transaction ID used to insert data. You can count the actual records using the transactionid. Replace X with your transactionid:\n\n```\nset hive.optimize.ppd=false;\nselect count(*) from hello_acid where row__id.writeid = {writeid};\n```\n\nKeep in mind that data from this transaction may have been deleted by a subsequent UPDATE or DELETE statement, so if the counts don’t match, consider if records may be altered some other way.\n\nUse information related to this hidden field very carefully.\n","user":"etl_user","dateUpdated":"2020-01-09T02:20:53+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578536345919_461691817","id":"20200109-021905_2014734671","dateCreated":"2020-01-09T02:19:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:25835","dateFinished":"2020-01-09T02:20:53+0000","dateStarted":"2020-01-09T02:20:53+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>A common need is to confirm that all records were ingested. Let’s say your upstream provider insists data is missing in Hive. Your provider (e.g. Storm Bolt) can tell you the transaction ID used to insert data. You can count the actual records using the transactionid. Replace X with your transactionid:</p>\n<pre><code>set hive.optimize.ppd=false;\nselect count(*) from hello_acid where row__id.writeid = {writeid};\n</code></pre>\n<p>Keep in mind that data from this transaction may have been deleted by a subsequent UPDATE or DELETE statement, so if the counts don’t match, consider if records may be altered some other way.</p>\n<p>Use information related to this hidden field very carefully.</p>\n\n</div>"}]}},{"text":"%md\n","user":"etl_user","dateUpdated":"2020-01-09T02:20:52+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578536452991_-1456187218","id":"20200109-022052_1090874719","dateCreated":"2020-01-09T02:20:52+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:26331"}],"name":"Demos / Hive ACID","id":"2EZM9PAXV","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"jdbc:shared_process":[],"livy:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}