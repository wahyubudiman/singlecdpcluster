{"paragraphs":[{"text":"%md\n## Create Hive views of Twitter & Weblog data","dateUpdated":"Apr 10, 2016 6:32:38 PM","config":{"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460313158821_-1507496252","id":"20160410-183238_1694581767","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Create Hive views of Twitter &amp; Weblog data</h2>\n"},"dateCreated":"Apr 10, 2016 6:32:38 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:469"},{"title":"Update permissions for tweets & weblogs","text":"%sh\nsudo -u hdfs hadoop fs -chmod -R 777 /tmp/tweets_staging\nsudo -u hdfs hadoop fs -chmod -R 777 /tmp/weblog_staging","dateUpdated":"Apr 10, 2016 6:33:03 PM","config":{"colWidth":12,"editorMode":"ace/mode/sh","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460313158821_-1507496252","id":"20160410-183238_1956630616","dateCreated":"Apr 10, 2016 6:32:38 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:470","dateFinished":"Apr 10, 2016 6:33:08 PM","dateStarted":"Apr 10, 2016 6:33:04 PM","result":{"code":"SUCCESS","type":"TEXT","msg":""},"focus":true},{"title":"Create Hive tables for tweets","text":"%hive\ncreate table if not exists tweets(\n  tweet_id bigint, \n  created_unixtime bigint, \n  created_time string, \n  displayname string, \n  msg string,\n  fulltext string\n)\nrow format delimited fields terminated by \"|\"\nlocation \"/tmp/tweets_staging\"","dateUpdated":"Apr 10, 2016 6:33:18 PM","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Update Count","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Update Count","index":0,"aggr":"sum"}}},"enabled":true,"tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460313158821_-1507496252","id":"20160410-183238_59510628","dateCreated":"Apr 10, 2016 6:32:38 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:471","focus":true,"dateFinished":"Apr 10, 2016 6:33:14 PM","dateStarted":"Apr 10, 2016 6:33:14 PM","result":{"code":"SUCCESS","type":"TABLE","msg":"Update Count\n-1\n","comment":"","msgTable":[[{"value":"-1"}]],"columnNames":[{"name":"Update Count","index":0,"aggr":"sum"}],"rows":[["-1"]]}},{"title":"Create Hive tables for weblogs","text":"%hive\ncreate table if not exists weblog(\n  clickid string,    \n  session int, \n  userid int, \n  visited timestamp, \n  product string\n)\nrow format delimited fields terminated by \",\"\nlocation \"/tmp/weblog_staging\"","dateUpdated":"Apr 10, 2016 6:33:27 PM","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Update Count","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Update Count","index":0,"aggr":"sum"}}},"enabled":true,"tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460313158821_-1507496252","id":"20160410-183238_2075545288","dateCreated":"Apr 10, 2016 6:32:38 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:472","dateFinished":"Apr 10, 2016 6:33:24 PM","dateStarted":"Apr 10, 2016 6:33:24 PM","result":{"code":"SUCCESS","type":"TABLE","msg":"Update Count\n-1\n","comment":"","msgTable":[[{"value":"-1"}]],"columnNames":[{"name":"Update Count","index":0,"aggr":"sum"}],"rows":[["-1"]]},"focus":true},{"title":"Check tweets table","text":"%hive\nselect * from tweets limit 5","dateUpdated":"Apr 10, 2016 6:33:31 PM","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460313158821_-1507496252","id":"20160410-183238_351800517","dateCreated":"Apr 10, 2016 6:32:38 PM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:473","dateFinished":"Apr 10, 2016 6:33:32 PM","dateStarted":"Apr 10, 2016 6:33:31 PM","focus":true},{"title":"Check weblog table","text":"%hive\nselect * from weblog limit 5","dateUpdated":"Apr 10, 2016 6:32:38 PM","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460313158821_-1507496252","id":"20160410-183238_510595858","dateCreated":"Apr 10, 2016 6:32:38 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:474"},{"text":"%md\n#### Analyze tables/columns for better performance\n\nNow lets run table level statistics on the tables we are interested in to improve query times\n","dateUpdated":"Apr 10, 2016 6:32:38 PM","config":{"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460313158821_-1507496252","id":"20160410-183238_2105264276","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>Analyze tables/columns for better performance</h4>\n<p>Now lets run table level statistics on the tables we are interested in to improve query times</p>\n"},"dateCreated":"Apr 10, 2016 6:32:38 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:475"},{"text":"%hive(default)\nanalyze table tweets compute statistics","dateUpdated":"Apr 10, 2016 6:34:28 PM","config":{"colWidth":4,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460313158822_-1506342006","id":"20160410-183238_888281597","dateCreated":"Apr 10, 2016 6:32:38 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:476","focus":true},{"text":"%hive(default)\nanalyze table weblog compute statistics","dateUpdated":"Apr 10, 2016 6:34:28 PM","config":{"colWidth":4,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"Update Count","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Update Count","index":0,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460313158822_-1506342006","id":"20160410-183238_1614329218","dateCreated":"Apr 10, 2016 6:32:38 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:477"},{"text":"%hive(default)\nanalyze table factsales_final compute statistics","dateUpdated":"Apr 10, 2016 6:34:29 PM","config":{"colWidth":4,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460313158822_-1506342006","id":"20160410-183238_111795476","dateCreated":"Apr 10, 2016 6:32:38 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:478"},{"text":"%md\nNext lets compute column statistics for the same tables","dateUpdated":"Apr 10, 2016 6:32:38 PM","config":{"colWidth":12,"editorHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460313158822_-1506342006","id":"20160410-183238_632658493","result":{"code":"SUCCESS","type":"HTML","msg":"<p>Next lets compute column statistics for the same tables</p>\n"},"dateCreated":"Apr 10, 2016 6:32:38 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:479"},{"text":"%hive(default)\nanalyze table tweets compute statistics for columns","dateUpdated":"Apr 10, 2016 6:34:29 PM","config":{"colWidth":4,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460313158822_-1506342006","id":"20160410-183238_28066439","dateCreated":"Apr 10, 2016 6:32:38 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:480"},{"text":"%hive(default)\nanalyze table weblog compute statistics for columns","dateUpdated":"Apr 10, 2016 6:34:29 PM","config":{"colWidth":4,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460313158822_-1506342006","id":"20160410-183238_605905813","dateCreated":"Apr 10, 2016 6:32:38 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:481"},{"text":"%hive(default)\nanalyze table factsales_final compute statistics for columns","dateUpdated":"Apr 10, 2016 6:34:29 PM","config":{"colWidth":4,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460313158823_-1506726755","id":"20160410-183238_1821657983","dateCreated":"Apr 10, 2016 6:32:38 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:482"},{"text":"%md\n## Use Hive to correlate the data from different sources","dateUpdated":"Apr 10, 2016 6:32:38 PM","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460313158823_-1506726755","id":"20160410-183238_1710837922","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Use Hive to correlate the data from different sources</h2>\n"},"dateCreated":"Apr 10, 2016 6:32:38 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483"},{"title":"Query A: Top 10 most visited products","text":"%hive(default)\nselect product,count(1) popular \nfrom weblog group by product order by popular desc limit 10","dateUpdated":"Apr 10, 2016 6:33:54 PM","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"pieChart","height":300,"optionOpen":false,"keys":[{"name":"product","index":0,"aggr":"sum"}],"values":[{"name":"popular","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"product","index":0,"aggr":"sum"},"yAxis":{"name":"popular","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460313158823_-1506726755","id":"20160410-183238_111320800","dateCreated":"Apr 10, 2016 6:32:38 PM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:484","dateFinished":"Apr 10, 2016 6:34:07 PM","dateStarted":"Apr 10, 2016 6:33:54 PM","focus":true},{"title":"Query B: Top products with most time spent by year","text":"%hive(default)\nselect product,year_visited, sum(time_spent) as total_time from\n(select table1.product,year(visited) as year_visited, \nmonth(visited) as month,unix_timestamp(table1.lead_window_0) - unix_timestamp(table1.visited) as time_spent\nfrom (select product,visited,lead(visited)  over (PARTITION BY session ORDER BY visited asc) from weblog) table1 \nwhere table1.lead_window_0 is not NULL) table2\ngroup by product,year_visited \norder by total_time desc limit 100","dateUpdated":"Apr 10, 2016 6:34:26 PM","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"product","index":0,"aggr":"sum"}],"values":[{"name":"total_time","index":2,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"product","index":0,"aggr":"sum"},"yAxis":{"name":"year_visited","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460313158823_-1506726755","id":"20160410-183238_1240220778","dateCreated":"Apr 10, 2016 6:32:38 PM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:485","dateFinished":"Apr 10, 2016 6:34:33 PM","dateStarted":"Apr 10, 2016 6:34:26 PM","focus":true},{"title":"Query C - most popular web_path","text":"%hive(default)\nselect web_path,count(1) as path_count\nfrom\n(select session,concat_ws(\"->\",collect_list(product)) as web_path\nfrom weblog group by session) table1\ngroup by web_path\norder by path_count desc","dateUpdated":"Apr 10, 2016 7:22:21 PM","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460313158823_-1506726755","id":"20160410-183238_132981147","dateCreated":"Apr 10, 2016 6:32:38 PM","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:486","dateFinished":"Apr 10, 2016 7:22:34 PM","dateStarted":"Apr 10, 2016 7:22:21 PM","focus":true},{"text":"%md\n\n#### Conclusion\n\nThis concludes the demo. We have shown how you can use Hive to get a single view of product by combining: \n  - ETL/CRM data from EDW/DB (ingested using Sqoop)\n  - web traffic  (ingested using HDF)\n  - social media data (ingested using HDF)\n","dateUpdated":"Apr 10, 2016 6:32:38 PM","config":{"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460313158823_-1506726755","id":"20160410-183238_675159428","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>Conclusion</h4>\n<p>This concludes the demo. We have shown how you can use Hive to get a single view of product by combining:</p>\n<ul>\n<li>ETL/CRM data from EDW/DB (ingested using Sqoop)</li>\n<li>web traffic  (ingested using HDF)</li>\n<li>social media data (ingested using HDF)</li>\n</ul>\n"},"dateCreated":"Apr 10, 2016 6:32:38 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:487"},{"text":"%md\n#### Next steps\n\nTry out the full lab available at: [https://github.com/abajwa-hw/single-view-demo](https://github.com/abajwa-hw/single-view-demo)","dateUpdated":"Apr 10, 2016 6:32:38 PM","config":{"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460313158823_-1506726755","id":"20160410-183238_989447165","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>Next steps</h4>\n<p>Try out the full lab available at: <a href=\"https://github.com/abajwa-hw/single-view-demo\">https://github.com/abajwa-hw/single-view-demo</a></p>\n"},"dateCreated":"Apr 10, 2016 6:32:38 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:488"},{"dateUpdated":"Apr 10, 2016 6:32:38 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460313158823_-1506726755","id":"20160410-183238_295509980","dateCreated":"Apr 10, 2016 6:32:38 PM","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:489"}],"name":"Single view - Analytics","id":"2BGMNVSUK","angularObjects":{"2BHF1YQU4":[],"2BFUFECZ7":[],"2BFS78D7X":[],"2BJ3XSZGS":[],"2BG5E2RDQ":[],"2BFGEHQMK":[],"2BGKHY6PM":[],"2BHU77U7J":[],"2BGE9XXA9":[],"2BJ55Z5ZP":[],"2BHEH6UEK":[],"2BJJJE6HG":[],"2BFX55QVZ":[],"2BJE2ZWVQ":[],"2BGEDT8GC":[]},"config":{"looknfeel":"default"},"info":{}}